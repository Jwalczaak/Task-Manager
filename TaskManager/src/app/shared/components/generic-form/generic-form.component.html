<form
  [formGroup]="form()"
  (ngSubmit)="onSubmit()"
  class="p-4 flex flex-column gap-4"
>
  @for (field of config().fieldsConfig; track field.label) {
  <div class="flex flex-column gap-2 w-full">
    <label>{{ field.label }}</label>

    @switch(field.type) { @case('text') {
    <input
      pInputText
      [formControlName]="field.name"
      [placeholder]="field.placeholder"
      class="w-full"
    />
    } @case('number') {
    <p-inputNumber
      [formControlName]="field.name"
      [min]="field.min"
      [max]="field.max"
      [placeholder]="field.placeholder"
      inputStyleClass="w-full"
    ></p-inputNumber>
    } @case('dropdown') {
    <p-select
      [formControlName]="field.name"
      [options]="field.options"
      optionLabel="value"
      optionValue="value"
      [placeholder]="field.placeholder"
      styleClass="w-full"
    ></p-select>
    } @case('multiselect') {
    <p-multiSelect
      [formControlName]="field.name"
      [options]="field.options"
      optionLabel="value"
      [placeholder]="field.placeholder"
      [maxSelectedLabels]="3"
      styleClass="w-full"
    ></p-multiSelect>
    } @case('date') {
    <p-datepicker
      [formControlName]="field.name"
      [placeholder]="field.placeholder"
      dateFormat="yy-mm-dd"
      styleClass="w-full"
    ></p-datepicker>
    } }

    <div
      *ngIf="getControl(field.name)?.touched && getControl(field.name)?.invalid"
      class="text-red-600 text-sm"
    >
      <small *ngIf="form().get(field.name)?.errors?.['required']"
        >{{ field.name }} is required</small
      >
      <small *ngIf="form().get(field.name)?.errors?.['min']"
        >Value is too low</small
      >
      <small *ngIf="form().get(field.name)?.errors?.['max']"
        >Value is too high</small
      >
    </div>
  </div>
  }

  <div class="flex justify-content-end">
    <p-button type="submit" [label]="config().buttonName"></p-button>
  </div>
</form>
